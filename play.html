<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width-device-width, initial-scale:1.0">
  <title>Play! - Cookie Clicker</title>
  <link rel="stylesheet" href="/styles.css">
  <link rel="icon" href="cookie.svg" type="image/x-icon">
</head>

<body class="noselect">
  <div class="contentFlex flexStart">
    <div class="header">
      <h1>Play!</h1>
    </div>
    <h4 class="hText">
      Click the cookie as fast as you can before the time runs out!
      <br />
      Think you can beat the
      <a href="/app/leaderboard"><u>high score</u></a>?
      Start clicking to play!
    </h4>
    <div class="gameBox">
      <div class="gameCookie splashLeft"></div>
      <div class="scoreColumn">
        <div class="countCell">
          <h2 class="hText inline">Cookies: 32</h2>
        </div>
        <div class="countCell">
          <h2 class="hText inline">Time: 0:10</h2>
        </div>
        <div class="countCell">
          <h3 class="hText">High score: 32</h3>
        </div>
      </div>
    </div>
    <div class="loginBox"><a href="/app/dashboard"><u>Back to dashboard</u></a></div>
  </div>
  <script>
    var score = 0;
    //This gets the current users data from the userInfo table and stores it in currentUserInfo
    var xmlHttp = new XMLHttpRequest();
    xmlHttp.open("GET", '/app/getCurrentUser/', false);
    xmlHttp.send(null);
    //Current user info ******
    const currentUserInfo = JSON.parse(xmlHttp.responseText);
    console.log(currentUserInfo);
    //Current user's ID #
    var currId = currentUserInfo.id;
    var currUser = currentUserInfo.user;


    //TODO: Once the game ends we need to send the score to the database
    function sendResults() {
      console.log(currUser);
      var xmlHttp = new XMLHttpRequest();
      xmlHttp.open("post", '/app/score/', false);
      xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
      xmlHttp.send("user="+currUser+"&score="+score);
      console.log(xmlHttp.responseText);
    }
  </script>
</body>

</html>